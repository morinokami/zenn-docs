---
title: "クライアントサイドレンダリング"
---

---

> アプリケーションの UI をクライアント上でレンダリングする

---

![](/images/learning-patterns/client-side-rendering-1280w.jpg)

クライアントサイドレンダリング (Client-Side Rendering、CSR) では、サーバーがレンダリングするのは、ページの骨格となる HTML コンテナのみです。ページ上にコンテンツを表示するために必要なロジック、データの取得、テンプレート化、ルーティングは、ブラウザあるいはクライアント上で実行される JavaScript コードによって処理されます。CSR は、シングルページアプリケーションを構築するための手法として普及し、Web サイトをインストール形式のアプリケーションに近づけることに貢献しました。

他のパターンの利点をよりよく理解するためにも、まずはクライアントサイドレンダリング (CSR) について深く考察し、それがどのような場面で上手く機能するのか、またどのような欠点をもつのかについて確認していきましょう。

## CSR の基本構造

React を使用してページ上に現在時刻を表示・[更新する](https://reactjs.org/docs/rendering-elements.html#updating-the-rendered-element)簡単な例を見てみます。

HTML:

```html
<div id="root"></div>
```

JS:

```jsx
function tick() {
  const element = (
    <div>
      <h1>Hello, world!</h1>
      <h2>It is {new Date().toLocaleTimeString()}.</h2>
    </div>
  );
 ReactDOM.render(element,document.getElementById('root'));
}
setInterval(tick, 1000);
```

HTML は、1 つのルート div タグだけで構成されています。一方、コンテンツの表示と更新に関しては、すべて JavaScript によって処理されます。サーバーへのラウンドトリップはなく、レンダリングされた HTML はその場で更新されます。時刻の代わりに、為替レートや株価など、API から取得したリアルタイムの情報を、ページのリロードやサーバーとのラウンドトリップなしで表示することも可能です。

## JavaScript のバンドルとパフォーマンス

画像やデータストアから得たデータの表示、イベント処理などのためにページの複雑さが増すにつれて、ページのレンダリングに必要な JavaScript コードの複雑さとサイズも大きくなっていきます。大きな JavaScript バンドルによる CSR は、ページの FCP と TTI を増加させます。

![](/images/learning-patterns/client-side-rendering-1.png)

画像の出典: https://www.youtube.com/watch?v=k-A2VfuUROg&feature=youtu.be

上の図からわかるように、bundle.js のサイズが大きくなると、FCP と TTI は右方向に押し出されます。これは、FP から FCP までの間ずっと、ユーザーは真っ白な画面を見続けることを意味します。

## クライアントサイド React の長所と短所

React では、アプリケーションロジックのほとんどはクライアント上で実行され、データの取得や保存のために API コールを通じてサーバーとやり取りをおこないます。つまり、ほぼすべての UI がクライアント上で生成されるということになります。Web アプリケーション全体は、最初のリクエストで読み込まれます。ユーザーがリンクをクリックしてページ遷移しても、ページをレンダリングするためのサーバーへのリクエストは発生しません。ビューやデータを変更するためのコードは、クライアント上で実行されるのです。

CSR により、ページを更新せずにナビゲーションをおこなうシングルページアプリケーションが可能となり、優れたユーザーエクスペリエンスを提供できるようになりました。ビューを変更するために処理されるデータはそれほど多くはないため、ページ間のルーティングは一般に速く、CSR アプリケーションの応答性を高く見せることができます。また、CSR により、開発者はクライアントとサーバーのコードを明確に分離することができます。

このように素晴らしいインタラクティブな体験を提供する CSR ですが、いくつかの落とし穴もあります。

1. **SEO に対する考慮**: 多くのウェブクローラーは、サーバーでレンダリングされたウェブサイトをそのまま解釈することができます。ところが、クライアントサイドレンダリングでは、事態は少し複雑になります。ペイロードは大きく、大量のネットワークリクエスト (たとえば API レスポンス) も発生するため、クローラーがインデックスを終えるまでに、意味のあるコンテンツをレンダリングできないことがあるためです。クローラーは JavaScript を解釈できるかもしれませんが、それも限界があります。そのため、クライアント上でレンダリングされるウェブサイトを SEO フレンドリーにするためには、なんらかの措置が必要となるのです。
2. **パフォーマンス**
3. **コードの保守性**
4. **データの取得**